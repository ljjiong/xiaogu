<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=no, width=device-width">
  <meta name="keywords" content="wancllshop">
  <title></title>
  <!-- 公共资源文件引入 -->
  <link rel="stylesheet" href="/public/static/common/css/loading.css" type="text/css">

  <link rel="stylesheet" href="/public/static/wap/aui/css/aui.css" type="text/css">
  <link rel="stylesheet" href="/public/static/wap/css/wap.css" type="text/css">
  <link rel="stylesheet" type="text/css" href="/public/static/wap/aui/css/aui-flex.css" />

  <!-- 图标库 -->
  <link rel="stylesheet" type="text/css" href="/public/static/common/css/ali_icon/iconfont.css" />

  <script src="/public/static/jquery-3.2.1.min.js" type="text/javascript"></script>
  <script src="/public/static/layer-v3.1.1/layer/layer.js" type="text/javascript"></script>
  <script src="/public/static/vue/vue-2.5.15/vue.min.js" type="text/javascript"></script>


  <script src="/public/static/common/script/common.js" type="text/javascript"></script>
  <script src="/public/static/common/script/config.js" type="text/javascript"></script>
  <script src="/public/static/common/script/wapRouter.js" type="text/javascript"></script>

  <script src="/public/static/axios/axios.min.js"></script>
  <script src="/public/static/common/script/httpPromise.js"></script>
  <link rel="icon" id="icon-img" href="" type="image/x-icon"/>


  <!-- <script>
    document.title = getStorage('systemParams').system_title || ''
    document.getElementById("icon-img").href = getStorage('systemParams').web_icon;
  </script> -->
<link rel="stylesheet" href="/public/static/OwlCarousel2-2.2.1/assets/owl.carousel.min.css">
<link rel="stylesheet" href="/public/static/OwlCarousel2-2.2.1/assets/owl.theme.default.min.css">
<script src="/public/static/OwlCarousel2-2.2.1/owl.carousel.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
    .wallet-btn{padding: 2px 10px 2px 5px;margin: 0 2px;}
    .wallet-type{width: 180px;margin: auto}
    .wallet-order{width: 350px;margin: auto}
    .wallet-nember{width: 110px;margin: auto}
</style>
</head>
<body>
	{include file="/index/header" /}
	<div id="app">
	<div class="w1200 margin-tt-15 over  black-text">
            <div class="left">
                    <!-- 个人信息卡 -->
                    <div class="card-title-wrap">
                        <img  src="/public/static/portal/img/title-back.png" class="responsive-img">
                        <div class="margin-10 over card-text-wrap">
                            <div class="ridius-img left margin-15">
                                <img :src="user.avatar" alt="">
                            </div>
                            <div class="left margin-top-15">
                                <div class="font-size-18 margin-top-15 white-text" v-text="user.mobile"></div>
                                <div class="blue lighten-1 margin-top-5" style="border-radius: 4px;padding: 2px 4px;">
                                    <img src="/public/static/portal/img/lr.png" alt="">
                                    <span class="font-size-12 white-text" v-text="level"></span>
                                </div>
                            </div>
                        </div>
                        <div class="rate-line font-size-12 blue-text text-lighten-5">
                            <div class="rataing-nember  margin-15" v-text=" '成长值  ' + score"></div>
                            <div class="ratas-nember right"></div>	
                        </div>
                    </div>
                    <div class="white grey-text text-darken-3 margin-top-15" style="border-radius: 5px">
                        <div class="card-right-nav-box  margin-10 padding-tt-10" style="border: none">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                    <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">交易管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                    <li class="margin-tt-13" @click="goto('cart_list')">购物车</li>
                                    <li class="margin-tt-13" @click="goto('order_list')">我的订单</li>
                                    <li class="margin-tt-13" @click="goto('comment_list')">我的评价</li>
                                </ul>
                            </div>
                        </div>
                        <div class="card-right-nav-box  margin-10 padding-tt-10">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                        <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">账号管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                    <li class="margin-tt-13" @click="goto('setting')">个人信息</li>
                                    <li class="margin-tt-13" @click="goto('account')">账号安全</li>
                                    <li class="margin-tt-13" @click="goto('idcard_auth')" >实名认证</li>
                                    <li class="margin-tt-13" @click="goto('address_list')">地址管理</li>
                                    <li class="margin-tt-13"  @click="goto('collection_list')">我的收藏</li>
                                    <li class="margin-tt-13"  @click="goto('level')">成长值<span class="blue-text text-lighten-1" v-text="'('+score+')'"></span></li>
                                    <li class="margin-tt-13"  @click="goto('bind')">第三方账户</li>
                                </ul>
                            </div>
                        </div>
                        <div class="card-right-nav-box margin-10 padding-tt-10">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                        <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">资产管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                    <li class="margin-tt-13" @click="goto('wallet')">我的钱包</li>
                                    <li class="margin-tt-13" @click="goto('bankcard_list')">我的银行卡</li>
                                    <li class="margin-tt-13" @click="goto('my_coupon_list')">我的优惠券<span class="blue-text text-lighten-2"></span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div> 	   		
		<div class="right right-content">
            <div class="white padding-15 ridius5">
                <div class="margin-tt-15 center border-btn padding-btn-15">
                    <div class="grey-text text-darken-3 font-size-12 ">钱包总余额</div>
                    <div class="margin-tt-5 red-text font-size-20 font-w" v-text="'￥' + money"></div>
                    <div class="margin-tt-15">
                        <span class="blue white-text radius3 wallet-btn bt" @click="goto('recharge')"><i class="iconfont icon-tixian padding-lr-5"></i>余额充值</span>
                        <span class="red white-text radius3 wallet-btn bt" @click="goto('withdraw')" ><i class="iconfont icon-chongzhi padding-lr-5"></i>零钱提现</span>
                    </div>
                </div>
                <div class="grey-text text-darken-2 margin-btn-15">消费明细</div>
                <div class="border-grey" style="border-bottom: none">
                <div class="grey-text grey lighten-3 padding-5 flex center">
                   <div class="flex1">日期时间</div>
                   <div class="wallet-type center">操作</div>
                   <div class="wallet-order center">单号</div>
                   <div class="wallet-nember ">金额</div>
                </div>
                <div v-for="log in logs">
                <div class="margin-top-10 padding-tt-5 setting-order-title">
                    <div class="flex padding-btn-15  grey-text text-darken-3 center">
                        <div class="flex1" v-text="log.create_time"></div>
                        <div class="wallet-type" v-text="log.intro"></div>
                        <div class="wallet-order" v-text="log.desc"></div>
                        <div class="wallet-nember " v-text="'-' + log.change_money">-1000</div>
                    </div>
                </div>
                </div>
            </div>
            </div>
            <div class="fen-page" style="margin-top:24px;text-align:left;margin-left:23px;margin-bottom:12px;" v-if="page_count > page_size">
                        <span v-for="(page,key) in pages" v-text="page" @click="getPage(page)"></span>
                    </div>
			<div class="margin-top-15">
					<img src="/public/static/portal/img/lien-img.png" alt="" class="responsive-img">
			</div>
		</div>
	</div>
	<div class="w1200 white over margin-btn-15">
		<div class="foot-list-title black-text text-lighten-1 margin-15 font-size-18 padding-left-15">猜你喜欢</div>
		<div class="foot-list margin-15 over">
            <div class="left foot-list-box" v-for="guessGood in guessGoods"  @click="goto('goods_detail',{goodsId:guessGood.id})">
                <img :src="guessGood.thum" class="responsive-img">
                <div class="padding-10">
                    <div class="font-size-16 black-text" v-text="guessGood.name"></div>
                    <div class="margin-top-10 over">
                        <div class="left">
                            <span class="red-text font-size-16" v-text="'￥' + guessGood.sell_price"></span>
                            <span class="font-size-10 grey-text lighten-1" v-text="'￥' + guessGood.sell_price"></span>
                        </div>
                        <div class="right font-size-12 grey-text lighten-1" v-text="'月销量：'+guessGood.sell_num"></div>
                    </div>
                </div>
            </div>
        </div>
	</div>
</div>
	{include file="index/footer" /}
	<script>
		var app = new Vue({
      el: '#app',
      data: {
        page:1,
        activeFooterIndex: 4,
        title: '成长值',
        user: user,
        level: '',
        score: '',
        logs:[],
        haveNoData:false,
        pages: [],
        page_count:'',
        page_size:'',
        money:'',
        guessGoods:[],
      },
      methods: {
        authentication: function () {
          httpRequest('POST', 'api_query/users/auth',{},function (resp) {
          	console.log(resp);
            var status = resp.data.status;
            if (status == 0 || status == 2) {
              goto('idcard_auth', { status: status, id: resp.data.id });
            } else if (status == 1 || status == 3) {
              goto('idcard_info');
            }
          })
        },
        getPage: function (data) {
            app.pages = []
            this.activeclass = data
            app.logs = []
            loadOrders(data)
        }
      },
      mounted: function () {
          
        httpRequest('POST', 'api_query/users/asset',{},function (resp) {
            app.level = resp.data.level;
            app.score = resp.data.score;
            app.money = resp.data.money;
          })
          httpRequest('POST', 'api_users/user_asset_logs/lists', {asset_type: 'money'},function (resp){
          	if(resp.data.length>0){
          		app.haveNoData = false;
                var data_count = resp.page.data_count;
                app.page_count = data_count;
                app.page_size = resp.page.page_limit;
                pagesStatus(data_count);
          		resp.data.forEach(function (item) {
                    item.intro = item.intro.substring(0,4); 
                    item.desc = item.desc.substring(11,31); 
                    app.logs.push(item);
                })
          		app.logs = resp.data;
          	}else{
          		app.haveNoData = true;
          	}
                },{
                'page-num':1,
                'page-limit': 10
            })
                httpRequest('POST','api_goods/goods/lists',{is_top:1},function(resp){
                    app.guessGoods = resp.data;
                },{'page-num':1,'page-limit':4})
      }
    })
    loadOrders = function(pages){
        var page = pages || 1;
        httpRequest('POST', 'api_query/users/asset',{},function (resp) {
            app.level = resp.data.level;
            app.score = resp.data.score;
            app.money = resp.data.money;
          })
          httpRequest('POST', 'api_users/user_asset_logs/lists', {asset_type: 'money'},function (resp){
            if(resp.data.length>0){
                app.haveNoData = false;
                var data_count = resp.page.data_count;
                app.page_count = data_count;
                app.page_size = resp.page.page_limit;
                pagesStatus(data_count);
                resp.data.forEach(function (item) {
                    item.intro = item.intro.substring(0,4); 
                    item.desc = item.desc.substring(11,31); 
                    app.logs.push(item);
                })
                if (resp.data.length == 10) {
                    app.page++;
                    document.body.onscroll = scrollEvent;
                } else {
                    document.body.onscroll = null;
                }
                app.logs = resp.data;
            }else{
                app.haveNoData = true;
            }
          },{
                'page-num': page,
                'page-limit': 10
            })
    }
    pagesStatus = function (data) {
        app.pages = []
        var page_li = Math.ceil(data / 10);
        if (!data) {
            page_li = 0;
            return;
        }
        for (var index = 1; index < page_li + 1; index++) {
            app.pages.push(index);
        };
    }
	</script>
</body>

</html>