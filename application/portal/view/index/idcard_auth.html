<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=no, width=device-width">
  <meta name="keywords" content="wancllshop">
  <title></title>
  <!-- 公共资源文件引入 -->
  <link rel="stylesheet" href="/public/static/common/css/loading.css" type="text/css">

  <link rel="stylesheet" href="/public/static/wap/aui/css/aui.css" type="text/css">
  <link rel="stylesheet" href="/public/static/wap/css/wap.css" type="text/css">
  <link rel="stylesheet" type="text/css" href="/public/static/wap/aui/css/aui-flex.css" />

  <!-- 图标库 -->
  <link rel="stylesheet" type="text/css" href="/public/static/common/css/ali_icon/iconfont.css" />

  <script src="/public/static/jquery-3.2.1.min.js" type="text/javascript"></script>
  <script src="/public/static/layer-v3.1.1/layer/layer.js" type="text/javascript"></script>
  <script src="/public/static/vue/vue-2.5.15/vue.min.js" type="text/javascript"></script>


  <script src="/public/static/common/script/common.js" type="text/javascript"></script>
  <script src="/public/static/common/script/config.js" type="text/javascript"></script>
  <script src="/public/static/common/script/wapRouter.js" type="text/javascript"></script>

  <script src="/public/static/axios/axios.min.js"></script>
  <script src="/public/static/common/script/httpPromise.js"></script>
  <link rel="icon" id="icon-img" href="" type="image/x-icon"/>


  <!-- <script>
    document.title = getStorage('systemParams').system_title || ''
    document.getElementById("icon-img").href = getStorage('systemParams').web_icon;
  </script> -->
<!-- <script src="/public/static/common/js/city.js" type="text/javascript"></script> -->
<style>
	.idcard-add{height: 160px;width: 260px;text-align: center;vertical-align:middle;}
	.idcard-img{height: 160px;width: 260px;overflow: hidden;position: relative;}
	.idcard-img span{position: absolute;top: 45%;left: 45%;}
	.idcard-img img{width: 260px;position: absolute;top:50%;left: 50%; transform: translate(-50%,-50%)}
</style>

</head>

<body>
	<div id="app">
	{include file="/index/header" /}
	<div class="w1200 margin-tt-15 over  black-text">
			<div class="left">
					<!-- 个人信息卡 -->
					<div class=" card-title-wrap">
							<img  src="/public/static/portal/img/title-back.png" class="responsive-img">
							<div class="margin-10 over card-text-wrap">
									<div class="ridius-img left margin-15">
											<img :src="user.avatar" alt="">
									</div>
									<div class="left margin-top-15">
											<div class="font-size-18 margin-top-15 white-text" v-text="user.mobile"></div>
											<div class="blue lighten-1 margin-top-5" style="border-radius: 4px;padding: 2px 4px;">
													<img src="/public/static/portal/img/lr.png" alt="">
													<span class="font-size-12 white-text" v-text="level"></span>
											</div>
									</div>
							</div>
							<div class="rate-line font-size-12 blue-text text-lighten-5">
									<div class="rataing-nember  margin-15" v-text=" '成长值  ' + score"></div>
									<div class="ratas-nember right"></div>	
							</div>
					</div>
					<div class="white grey-text text-darken-3 margin-top-15" style="border-radius: 5px">
							<div class="card-right-nav-box  margin-10 padding-tt-10" style="border: none">
									<div class="card-right-nav">
											<div class="font-size-18 over margin-tt-10">
													<i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
													<span class="left margin-top-5">交易管理</span>
											</div>
											<ul class="card-right-nav-ul">
													<li class="margin-tt-13" @click="goto('cart_list')">购物车</li>
													<li class="margin-tt-13" @click="goto('order_list')">我的订单</li>
													<li class="margin-tt-13" @click="goto('comment_list')">我的评价</li>
											</ul>
									</div>
							</div>
							<div class="card-right-nav-box  margin-10 padding-tt-10">
									<div class="card-right-nav">
											<div class="font-size-18 over margin-tt-10">
															<i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
													<span class="left margin-top-5">账号管理</span>
											</div>
											<ul class="card-right-nav-ul">
													<li class="margin-tt-13" @click="goto('setting')">个人信息</li>
													<li class="margin-tt-13" @click="goto('account')">账号安全</li>
													<li class="margin-tt-13" @click="goto('idcard_auth')" >实名认证</li>
													<li class="margin-tt-13" @click="goto('address_list')">地址管理</li>
													<li class="margin-tt-13"  @click="goto('collection_list')">我的收藏</li>
													<li class="margin-tt-13"  @click="goto('level')">成长值<span class="blue-text text-lighten-1" v-text="'('+score+')'"></span></li>
													<li class="margin-tt-13"  @click="goto('bind')">第三方账户</li>
											</ul>
									</div>
							</div>
							<div class="card-right-nav-box margin-10 padding-tt-10">
									<div class="card-right-nav">
											<div class="font-size-18 over margin-tt-10">
															<i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
													<span class="left margin-top-5">资产管理</span>
											</div>
											<ul class="card-right-nav-ul">
													<li class="margin-tt-13" @click="goto('wallet')">我的钱包</li>
													<li class="margin-tt-13" @click="goto('bankcard_list')">我的银行卡</li>
													<li class="margin-tt-13" @click="goto('my_coupon_list')">我的优惠券<span class="blue-text text-lighten-2" v-if="coupons.length" v-text=" '('+ coupons.length + ')'"></span></li>
											</ul>
									</div>
							</div>
					</div>
			</div>	
		<div class="right right-content" >
			<div class="padding-15 white"  >
				<div class="font-size-16 black-text padding-tt-15 border-btn">实名认证</div>
				
				<div class="addresses-add">
					<div class="flex margin-tt-15">
						<div class="addresses-add-text">
							<img src="/public/static/portal/img/red-xin.png" class="responsive-img" v-if="querystring.status != 3" >真实姓名
						</div>
						<div class="border-grey" style="width: 250px">
							<input type="text" placeholder="请输入您的真实姓名" v-model="name">
						</div>
					</div>
					<div class="flex margin-tt-15">
							<div class="addresses-add-text">
								<img src="/public/static/portal/img/red-xin.png" class="responsive-img"  v-if="querystring.status != 3">身份证号
							</div>
							<div class="border-grey"  style="width: 250px">
								<input type="text" placeholder="请输入身份证号码" v-model="idcard">
							</div>
						</div>
					
					<div class="flex margin-tt-15">
						<div class="addresses-add-text" style="margin:0 30px;"  v-if="querystring.status != 3">
							上传照片
						</div>
						<div class="margin-right-15">
							<div class="grey lighten-3 idcard-add grey-text text-darken-2 idcard-img" @click="fileClick(1)"><span>+正面 </span>	<img :src="idcard_front"></div>
						
							<input @change="fileChange($event, 'idcard_front')" type="file" id="upload_file1" style="display: none">
							<div class="center">
								<div class="margin-tt-5">事例</div>
								<img src="/public/static/portal/img/idcard-1.png" class="responsive-img">
							</div>
						</div>
						<div class="margin-right-15">
								<div class="grey lighten-3 idcard-add grey-text text-darken-2 idcard-img"  @click="fileClick(2)"> <span>+侧面 </span> <img :src="idcard_back"></div>
								
								  <input @change="fileChange($event, 'idcard_back')" type="file" id="upload_file2" style="display: none">
								<div class="center">
									<div class="margin-tt-5">事例</div>
									<img src="/public/static/portal/img/idcard-2.png" class="responsive-img">
								</div>
						</div>
					</div>
					<div class="flex">
							<div class="addresses-add-text">
								<!-- <img  src="/public/static/portal/img/red-xin.png" class="responsive-img"> -->
							</div>
							<div class="grey-text font-size-12 flex1 over margin-tt-15">
								<div class="">注：</div>
								<div class="margin-left-5">1.需上传清晰的身份证正面，反面共两张照片</div>
								<div class="margin-left-5">2.照片不超过5MB，支持格式jpg，jpeg，png</div>
							</div>
						</div>
					<div class="flex">
						<div class="addresses-add-text">
							<!-- <img  src="/public/static/portal/img/red-xin.png" class="responsive-img"> -->
						</div>
						<div class="flex1 over margin-tt-15">
							<div class="left">
									<span class="address-yes pointer" style="margin: 0"  @click="submit()"  v-if="querystring.status != 3">提交</span>
									<span class="address-yes" style="margin: 0"   v-if="querystring.status == 3">审核已通过</span>
							</div>

						</div>
					</div>
				</div>
				
			</div> 
			<div class="margin-top-15">
					<img src="/public/static/portal/img/lien-img.png" alt="" class="responsive-img">
				</div>
		</div>
		<div class="w1200 white over margin-btn-15">
			<div class="foot-list-title black-text text-lighten-1 margin-15 font-size-18 padding-left-15">猜你喜欢</div>
			<div class="foot-list margin-15 over">
	            <div class="left foot-list-box" v-for="guessGood in guessGoods"  @click="goto('goods_detail',{goodsId:guessGood.id})">
	                <img :src="guessGood.thum" class="responsive-img">
	                <div class="padding-10">
	                    <div class="font-size-16 black-text" v-text="guessGood.name"></div>
	                    <div class="margin-top-10 over">
	                        <div class="left">
	                            <span class="red-text font-size-16" v-text="'￥' + guessGood.sell_price"></span>
	                            <span class="font-size-10 grey-text lighten-1" v-text="'￥' + guessGood.sell_price"></span>
	                        </div>
	                        <div class="right font-size-12 grey-text lighten-1" v-text="'月销量：'+guessGood.sell_num"></div>
	                    </div>
	                </div>
	            </div>
        	</div>
		</div>
	</div>
		
		<footer class="aui-bar aui-bar-tab" id="footer">
  <div class="aui-bar-tab-item" onclick="goto('index')" :class="{'icon-footer-active' : (activeFooterIndex == 1 )}">
    <div class="icon-div">
      <img v-if="activeFooterIndex == 1" src="/public/static/wap/img/icon12.png">
      <img v-else src="/public/static/wap/img/icon11.png">
    </div>
    <div class="aui-bar-tab-label">任务</div>
  </div>
  <div class="aui-bar-tab-item" onclick="goto('personnel_page')"
    :class="{'icon-footer-active' : (activeFooterIndex == 2 )}">
    <div class="icon-div">
      <img v-if="activeFooterIndex == 2" src="/public/static/wap/img/icon22.png">
      <img v-else src="/public/static/wap/img/icon21.png">
    </div>
    <div class="aui-bar-tab-label">行政</div>
  </div>
  <div class="aui-bar-tab-item" onclick="goto('home')" :class="{'icon-footer-active' : (activeFooterIndex == 3 )}">
    <!-- <div class="aui-badge">99</div> -->
    <div class="icon-div">
      <img v-if="activeFooterIndex == 3" src="/public/static/wap/img/icon32.png">
      <img v-else src="/public/static/wap/img/icon31.png">
    </div>
    <div class="aui-bar-tab-label">我的</div>
  </div>
</footer>
</body>
 <script>
    var app = new Vue({
      el: '#app',
      data: {
        title: '实名认证',
        idcard_front: '',
				idcard_back: '',
				user:user,
				level: '',
        score: '',
        name:'',
        idcard:'',
      	status:'',
      	querystring:{
	      	status:'',
			id:'',
		},
		coupons:'',
      	auth_info:{},
      	guessGoods:[],
      },
      methods: {
        submit: function () {
					var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
					if (!this.name) {
            layer.msg('请输入您的真实姓名');
            return;
          }
					if (reg.test(this.idcard) === false) {
            layer.msg('请输入正确的身份证号');
            return;
          }
          if (!app.idcard_front) {
            layer.msg('请上传身份证正面照片');
            return;
          }
          if (!app.idcard_back) {
            layer.msg('请上传身份证反面照片');
            return;
          }
          layer.confirm('确认提交审核?', { icon: 3, title: '提示' }, function (index) {
            layer.close(index);

            if (app.querystring.status == 0) {
              var router = 'api_users/user_auths/save';
              var data = {
                id_card_front_img: app.idcard_front,
                id_card_back_img: app.idcard_back,
                status: 1,
                name:app.name,
                id_card:app.idcard,
              };
            } else {
              var router = 'api_users/user_auths/update';
              var data = {
                id: app.querystring.id,
                id_card_front_img: app.idcard_front,
                id_card_back_img: app.idcard_back,
                status: 1,
                name:app.name,
                id_card:app.idcard,
              }
            }
            console.log(data);

            httpRequest('POST', router, data,function (resp) {
              layer.msg('提交成功');
              setTimeout(function (resp) {
                location.reload();
              }, 500)
            })
          })
        },
        fileClick: function (type) {
          document.getElementById('upload_file' + type).click()
        },
        //文件发生该变
        fileChange: function (el, type) {
          if (!el.target.files[0].size) return;
          this.fileList(el.target, type);
          el.target.value = ''
        },
        //文件列表
        fileList: function (fileList, type) {
          var files = fileList.files;
          for (var i = 0; i < files.length; i++) {
            //判断是否为文件夹
            if (files[i].type != '') {
              this.fileAdd(files[i], type);
            } else {
              //文件夹处理
              this.folders(fileList.items[i], type);
            }
          }
        },
        //文件夹处理
        folders: function (files, type) {
          var _this = this;
          //判断是否为原生file
          if (files.kind) {
            files = files.webkitGetAsEntry();
          }
          files.createReader().readEntries(function (file) {
            for (var i = 0; i < file.length; i++) {
              if (file[i].isFile) {
                _this.foldersAdd(file[i], type);
              } else {
                _this.folders(file[i], type);
              }
            }
          })
        },
        foldersAdd: function (entry, type) {
          var _this = this;
          entry.file(function (file) {
            _this.fileAdd(file, type)
          })
        },
        fileAdd: function (file, type) {
          //判断是否为图片文件
          if (file.type.indexOf('image') == -1) {
            layer.msg('请选择图片类型的文件')
          } else {
            var that = this;
            var reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function () {
              file.src = this.result;
              that[type] = file.src;
            }

          }
        }
      },
      mounted: function () { 
	      httpRequest('POST', 'api_query/users/auth',{},function (resp) {
	      	 app.idcard_front  = resp.data.id_card_front_img;
	      	 app.idcard_back   = resp.data.id_card_back_img;
	      	 app.name          = resp.data.name;
	      	 app.idcard        = resp.data.id_card;
	      	 app.querystring.id= resp.data.id; 
					 app.querystring.status = resp.data.status;
					 return 
				})
				
				httpRequest('POST', 'api_query/users/asset',{},function(resp){
			    app.level = resp.data.level;
	        app.score = resp.data.score;
				}) 
							//猜你喜欢
				httpRequest('POST','api_goods/goods/lists',{is_top:1},function(resp){
            app.guessGoods = resp.data;
        },{'page-num':1,'page-limit':4})
      },

    }) 
  </script>

</html>